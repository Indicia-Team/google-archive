#summary Details on how to use the Report Calendar Summary prebuilt form.

= Introduction =

The report calendar summary form is used to output a calendar grid, showing the results of a report. The report used is assumed to be a date based report. This is used to fill in an array of counts, with a defined field as the vertical axis (eg taxon) and the week as the horizontal axis. The count can either be a simple count of the occurrences, or an occurrence attribute can be summed.

It is possible to define the start day of the week (ie the first column) and to output a week number column in the grid (with a configurable start point). It is also possible to restrict the weeks displayed to a defined range of week numbers.

= Using the report calendar summary prebuilt form =
Some knowledge of the report you are going to use is required in order to configure this form.

To use this prebuilt form from Drupal, select Create Content then Indicia Forms from the menu as for any other prebuilt form. Specify a title for the page then a little down the page enter your website ID and password. The Report Calendar Summary form is available from the Select Form drop-down after choosing the Reporting category first.

Once you have selected the Report Grid form click the Load Settings Form button. Drupal will load the settings form for the report grid which contains a number of options, each with help text explaining what they are for. Here are a list of the important ones:

*Report Name*: Select the report you want to use to populate the grid.

*Preset Parameter Values*: If you want to provide a parameter value for a report, you can specify them in this box. For example you might specify survey_id=4 to restrict the data to survey 4. Some reports may expect some fixed values like this.

*Include user specific location filter*: Choose whether to include a filter on the locations assigned to this user using the CMS User ID location attribute.

*Restrict locations to type*: Choose whether to restrict the locations in the filter above to a particular location type. This may be important if the CMS User ID attribute is only available to a particular location type.

*Location Parameter*: This is the parameter to the report which is used to pass the user specific location filter.

*Vertical Axis*: This is the field in the report which is used as the vertical axis value in the grid.

*Count Column*: This is the field in the report which is used to store the count associated with an occurrence. If left blank, the grid assumes a count of one per occurrence.

When you have finished with the settings save your page and test the report. It should show the calendar.

= Example Setup =
If we want
  * a calendar grid based on the "UKBMS Occurrence list for a CMS user" report for survey number 2 (this report is predefined: it takes a location defined by parameter "location_id", has date_from and date_to parameters for filtering, requires a survey_id in the presets and has a CMS User ID Sample attribute filter - this is distinct from the CMS User ID record required for the site filter)
  * where the week starts on the day of the week on which the 1st of April occurs,
  * week numbers where week one is also based on the 1st April,
  * restrict the display to week numbers -3 to 30
  * to include a filter on the sites, whose drop down list entries display Transects names and their associated coordinates (Sref)
  * to add up all the entries in the "Abundance Count" occurrence attribute

then we'd set up the parameters as follows:
 
  * Report Name: "UKBMS Occurrence list for a CMS user" under UKBMS
  * Preset Parameter Values:
{{{
survey_id=2
}}}
  * Include user specific location filter: Yes
  * Restrict locations to type: Transect
  * Include Sref in location filter name: Yes
  * Location Parameter: location_id
  * Start of week definition:"Apr-01"
  * Type of header rows to include in calendar grid: Both
  * Week One Contains:"Apr-01"
  * Restrict displayed weeks: "-3:30"
  * Vertical Axis: taxon
  * Count Column: Abundance Count

= Restrictions =
The report used must return the field "date".<br />The report should take the parameter "user_id" to filter the returned results by those samples generated by that particular CMS User.<br />The report may optionally take parameters "date_from" and "date_to", which are used by the form to filter the results returned to the year currently being queried. This is advisable but not essential, as any records outside this range will be ignored, but may cause empty rows to be displayed.<br />
In order to use the location filter, there must be
  # a "CMS User ID" location attribute associated with the locations, which is set to the CMS user id by the appropriate site generation method (eg form). If this attribute is restricted to a particular location_type, then this must be set in the "Restrict locations to type" field.
  # the report should accept the location ID passed through as the parameter defined in the "Location Parameter" form configuration item.

This form does not support an auto-generated parameters input form for missing parameters.