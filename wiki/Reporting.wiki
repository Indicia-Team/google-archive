#summary A description of the reporting facilities within Indicia
#labels Phase-Deploy

= Introduction =

Indicia uses a subset of the format used in Recorder to allow custom defined reporting. This document outlines how to define a report and how to use the Indicia reporting services to run it, either from the core module or from a site module.

= Details =

== Report Format ==

At the moment, reports must be defined in an XML document similar to that used in Recorder. No formal schema exists, but the structure is sufficiently simple that an example should suffice to allow you to write reports easily. If you wish to expand the capability to support other formats, you may do so by implementing the ReportReader interface and defining a report format in the ReportEngine class. Details of this are however beyond the scope of this document.

An XML defined report might look something like this:

{{{
<?xml version="1.0" encoding="UTF-8"?>

<report title="Recent Activity" description="Lists recent activity broken down by survey.">
      <query>
      SELECT su.title as survey, w.title as website, COUNT(*) as count FROM websites w 
      JOIN occurrences o ON o.website_id = w.id
      JOIN samples s ON o.sample_id = s.id
      JOIN surveys su ON s.survey_id = su.id
      WHERE o.created_on > '#date#%'::date
      GROUP BY survey, website
      </query>
      <order_bys>
            <order_by>website ASC</order_by>
	    <order_by>survey ASC</order_by>
      </order_bys>
      <params>
	    <param name='date' display='Since: ' description='Show activity since:' datatype='date' />
      </params>
      <columns>
            <column name="survey" display="Survey Name" style="color: #ff0000;"/>
            <column name="website" display="Website Name" />
            <column name="count" display="Total no. of Occurrences" />
      </columns>
</report>
}}}

This report will return details on recent observation activity, broken down by website and survey. It takes one parameter, `date`, which sets the point after which activity should be considered - for example, setting `date` one month ago would give a report on activity within the past month.

