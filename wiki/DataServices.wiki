#summary Information on calling the Data Services

= Introduction =

Indicia's Data Services provide a programmatic interface to information held in the Indicia core database. The Data Services are a RESTful web service, with each entity represented by a URL.

== Constructing the service URL ==

The Data Services are accessed via the URL of the site root + /index.php/services/data/ + the name of the required data entity, which is the singular version of the required table name, for example `http://www.mysite.com/index.php/services/data/termlist`

== Retrieving a single item of data ==

To retrieve a single item of data with a known id, append a forward slash then the item's id to the URL, for example `http://www.mysite.com/index.php/services/data/termlist/3` will retrieve the termlist with id 3.

== Retrieving a list of data ==

Retrieving a list of data can be achieved by ommitting the id from the URL. In this case, a number of GET parameters are available to control the output as follows:

||_fieldname_||If a parameter is provided which matches a field in the output data, then the value provided is used to filter on that field. When filtering against a text attribute, use an asterisk character to represent a wildcard if an inexact match is required.||
||orderby||Allows the field that the results are to be sorted by to be specified.||
||sortdir||Specifies the sort direction. Options are ASC or DESC.||
||limit||Limits the returned results to _n_ items.||
||offset||Starts the returned results offsetted by _n_ records.||

A full example illustrating this is `http://www.mysite.com/index.php/services/data/termlists_term?termlist=sample&term=quad&orderby=term&sortdir=desc&limit=10&offset=10&xsl=default.xsl`. This returns an XML document formatted using default.xsl, which lists all termlist terms from termlists that contain sample in their title, where the term contains quad. The results start at the 10th item in the list, are limited to a maximum of 10 entries, and are ordered by term descending.

== Output Attributes ==

Calls to the Data Services return a minimal amount of information for the entity by default, typically just the entity's id and caption field. The fields returned are those defined in the set of datasbase views called list_*** where *** is the table name. To return more details, specify a GET parameter "view=gv" or "view=detail", which returns either the columns in the main grid for the entity, or a detailed view of the entity respectively. Since additional query joins are required using these views will reduce performance.

== Output Mode ==

Calls to the URLs normally return a formatted XML document describing the results. This can be overridden by providing a GET parameter called mode in the URL to request json or csv data. Other formats can be supported by adding views that generate the formatted output to the modules/indicia_svc_data/views/services/data/_entity name_ folder.

=== JSONP ===

For cross-site retrieval using JSONP, an optional callback method can be specified by providing ?callback=_methodname_ in the GET string.

== Attaching XSL to XML output ==

By passing a GET parameter called xsl to the URL, an XSL transformation can be linked to by the returned XML document. Either a fully qualified path to the XSL document is required, or if just a file name is given then the XSL document must exist in the folder \media\services\stylesheets within the website root. An example file called default.xsl is provided. For example `http://www.mysite.com/index.php/services/data/termlist?xsl=default.xsl` retrieves the XML document listing all termlists into the browser and formats it on the client using the XSL file to appear as an HTML table.